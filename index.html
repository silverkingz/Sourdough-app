<!DOCTYPE html>
<html>
<head>
    <title>Sourdough Calculator Pro</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #fff8e5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        .input-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin: 10px 0;
        }
        input, select {
            padding: 5px;
            margin: 5px 0;
        }
        input[type="number"] {
            width: 100px;
        }
        input[type="range"] {
            width: 150px;
        }
        .buttons {
            display: flex;
            gap: 10px;
            margin: 20px 0;
        }
        button {
            padding: 10px 20px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button[type="submit"] {
            background: #ffc439;
            color: black;
        }
        #results, #schedule {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .schedule-step {
            margin: 10px 0;
            padding: 10px;
            border-left: 3px solid #4CAF50;
            background: #f9f9f9;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üçû Sourdough Calculator Pro</h1>

        <!-- Input Section -->
        <div class="input-group">
            <label>Recipe:
                <select id="recipe">
                    <option value="white">Classic White</option>
                    <option value="multigrain">Multigrain</option>
                    <option value="oat">Oat</option>
                    <option value="jalapeno">Jalape√±o Cheddar</option>
                </select>
            </label>

            <label>Number of Loaves: 
                <input type="number" id="loaves" value="1" min="1">
            </label>

            <label>Dough per Loaf (g): 
                <input type="number" id="doughWeight" value="800" min="400" max="2000">
            </label>

            <label>Hydration (%): 
                <input type="range" id="hydration" min="60" max="100" value="70"> 
                <span id="hydrationValue">70%</span>
            </label>

            <label>Temperature: 
                <input type="number" id="temperature" value="22" step="0.1">
                <select id="tempUnit">
                    <option value="C">¬∞C</option>
                    <option value="F">¬∞F</option>
                </select>
            </label>

            <label>Starter Type: 
                <select id="starterType">
                    <option value="50">Stiff (50%)</option>
                    <option value="100" selected>Liquid (100%)</option>
                </select>
            </label>
        </div>

        <!-- Buttons -->
        <div class="buttons">
            <button onclick="generateRecipe()">Generate Recipe & Schedule</button>
            <form action="https://www.paypal.com/donate" method="post" target="_blank">
                <input type="hidden" name="business" value="YOUR_PAYPAL_EMAIL">
                <input type="hidden" name="currency_code" value="USD">
                <button type="submit">‚òï Support This Project</button>
            </form>
        </div>

        <!-- Results -->
        <div id="results"></div>
        <div id="schedule"></div>
    </div>

    <script>
        const recipes = {
            white: {
                ingredients: {
                    flour: 500,
                    water: 350,
                    salt: 10
                },
                steps: [
                    "Autolyse (mix flour + water)",
                    "Add starter + salt",
                    "Bulk fermentation with folds",
                    "Shape and cold proof",
                    "Bake at 250¬∞C"
                ]
            },
            multigrain: {
                ingredients: {
                    flour: 400,
                    water: 300,
                    salt: 10,
                    grains: 100
                },
                steps: [
                    "Soak grains",
                    "Autolyse with flour + water",
                    "Add grains + starter + salt",
                    "Extended bulk fermentation",
                    "Shape and cold proof",
                    "Bake at 240¬∞C"
                ]
            },
            oat: {
                ingredients: {
                    flour: 450,
                    water: 320,
                    salt: 10,
                    oats: 50
                },
                steps: [
                    "Soak oats",
                    "Autolyse with flour + water",
                    "Add oats + starter + salt",
                    "Bulk fermentation with folds",
                    "Shape and cold proof",
                    "Bake at 230¬∞C"
                ]
            },
            jalapeno: {
                ingredients: {
                    flour: 500,
                    water: 350,
                    salt: 10,
                    cheese: 100,
                    jalapenos: 50
                },
                steps: [
                    "Prepare add-ins",
                    "Autolyse with flour + water",
                    "Add starter + salt",
                    "Laminate add-ins",
                    "Shape and cold proof",
                    "Bake at 240¬∞C"
                ]
            }
        };

        function generateRecipe() {
            // Clear previous results
            document.getElementById('results').innerHTML = '';
            document.getElementById('schedule').innerHTML = '';

            // Get inputs
            const recipeType = document.getElementById('recipe').value;
            const loaves = parseInt(document.getElementById('loaves').value) || 1;
            const doughPerLoaf = parseInt(document.getElementById('doughWeight').value) || 800;
            const hydration = parseInt(document.getElementById('hydration').value) / 100 || 0.7;
            const tempUnit = document.getElementById('tempUnit').value;
            const doughTemp = parseFloat(document.getElementById('temperature').value) || 22;
            const starterHydration = parseInt(document.getElementById('starterType').value) / 100 || 1;

            // Get selected recipe
            const recipe = recipes[recipeType];
            if (!recipe) return;

            // Calculate total dough weight
            const totalDough = doughPerLoaf * loaves;

            // Calculate scaled ingredients
            const scaledIngredients = {};
            for (const [ingredient, amount] of Object.entries(recipe.ingredients)) {
                scaledIngredients[ingredient] = (amount * (totalDough / doughPerLoaf) * loaves).toFixed(1);
            }

            // Adjust water for hydration
            scaledIngredients.water = (hydration * scaledIngredients.flour).toFixed(1);

            // Calculate bulk time
            const tempC = tempUnit === 'F' ? (doughTemp - 32) * 5/9 : doughTemp;
            const bulkHours = calculateBulkTime(tempC);

            // Generate schedule
            const now = new Date();
            const scheduleSteps = [];

            // Starter feeding
            const feedTime = new Date(now.getTime() - 12 * 60 * 60 * 1000);
            scheduleSteps.push(createStep(
                "Feed Starter",
                feedTime,
                `Use ${starterHydration * 100}% hydration (1:${starterHydration === 0.5 ? '2:2' : '1:1'} ratio)`
            ));

            // Autolyse
            const autolyseEnd = new Date(now.getTime() + 60 * 60 * 1000);
            scheduleSteps.push(createStep(
                "Autolyse",
                now,
                autolyseEnd,
                recipe.steps[0]
            ));

            // Bulk fermentation
            const bulkEnd = new Date(autolyseEnd.getTime() + bulkHours * 60 * 60 * 1000);
            scheduleSteps.push(createStep(
                "Bulk Fermentation",
                autolyseEnd,
                bulkEnd,
                `${recipe.steps[1]} (${bulkHours}h)`
            ));

            // Remaining steps
            let lastTime = bulkEnd;
            recipe.steps.slice(2).forEach((step, index) => {
                const duration = index === recipe.steps.length - 3 ? 1 : 0.5;
                const stepEnd = new Date(lastTime.getTime() + duration * 60 * 60 * 1000);
                scheduleSteps.push(createStep(
                    `Step ${index + 3}`,
                    lastTime,
                    stepEnd,
                    step
                ));
                lastTime = stepEnd;
            });

            // Display results
            displayResults(scaledIngredients, scheduleSteps);
        }

        function calculateBulkTime(tempC) {
            if (tempC >= 25) return 4;
            if (tempC >= 22) return 5;
            if (tempC >= 19) return 6;
            return 7;
        }

        function createStep(name, start, end, notes) {
            return {
                name,
                time: `${formatTime(start)} - ${formatTime(end)}`,
                notes
            };
        }

        function formatTime(date) {
            return date.toLocaleTimeString('en-US', { 
                hour: 'numeric', 
                minute: '2-digit', 
                hour12: true 
            });
        }

        function displayResults(ingredients, schedule) {
            // Show ingredients
            let ingredientsHTML = '<h3>üßæ Ingredients</h3>';
            for (const [name, amount] of Object.entries(ingredients)) {
                ingredientsHTML += `<p>${name.charAt(0).toUpperCase() + name.slice(1)}: ${amount}g</p>`;
            }
            document.getElementById('results').innerHTML = ingredientsHTML;

            // Show schedule
            let scheduleHTML = '<h3>‚è∞ Schedule</h3>';
            schedule.forEach(step => {
                scheduleHTML += `
                    <div class="schedule-step">
                        <strong>${step.name}</strong><br>
                        <em>${step.time}</em><br>
                        ${step.notes}
                    </div>
                `;
            });
            document.getElementById('schedule').innerHTML = scheduleHTML;
        }

        // Hydration slider update
        document.getElementById('hydration').addEventListener('input', function() {
            document.getElementById('hydrationValue').textContent = `${this.value}%`;
        });
    </script>
</body>
</html>
